{% extends "layout.html" %}

{% block body %}
<div class="container-fluid p-4">  

    <h1 class="text-center mb-4">å››è±¡é™ä»»åŠ¡ç®¡ç†</h1>

    <div class="row quadrant-container">
        {% for q in quadrants %}
        <div class="col-6 p-2">
            <div class="quadrant {{ q.q_class }} position-relative">
                <h4>{{ q.title }}</h4>

                <button class="btn btn-sm {{ q.btn_class }} add-task-btn position-absolute top-0 end-0 m-2"
                        data-quadrant="{{ q.id }}"
                        data-bs-toggle="modal"
                        data-bs-target="#taskModal">ï¼‹</button>

                <div class="task-list">
                    {% for t in tasks if t["quadrant"] == q.id %}
                        <div class="task-item card mb-2 p-2">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <strong class="task-name {% if t['completed'] %}completed{% endif %}">{{ t["name"] }}</strong>
                                    {% if t["ddl"] %}<span class="text-muted ms-2">({{ t["ddl"] }})</span>{% endif %}
                                    {% if t["content"] %}<p class="mb-1">{{ t["content"] }}</p>{% endif %}
                                    <small class="text-muted">é¢„è®¡ï¼š{{ t["duration"] }} åˆ†é’Ÿ</small>
                                </div>

                            <div class="task-actions d-flex align-items-center ms-3">
                                <button type="button" 
                                        class="btn btn-sm done-task-btn me-2" 
                                        data-id="{{ t['id'] }}" 
                                        data-completed="{{ t['completed'] }}">âˆš</button>
                                <button type="button" 
                                        class="btn btn-sm btn-outline-secondary edit-task-btn me-1" 
                                        data-id="{{ t['id'] }}" data-name="{{ t['name']|e }}" data-ddl="{{ t['ddl']|e }}" data-content="{{ t['content']|e }}" data-duration="{{ t['duration'] }}" data-quadrant="{{ t['quadrant'] }}" data-completed="{{ t['completed'] }}">âœ</button>
                                <button type="button" 
                                        class="btn btn-sm btn-outline-danger delete-task-btn" 
                                        data-id="{{ t['id'] }}">ğŸ—‘</button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% include "task_modal.html" %}

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='tasks.js') }}"></script>
{% endblock %}
